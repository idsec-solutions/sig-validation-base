<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_261) on Tue Oct 27 10:56:17 CET 2020 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>GeneralCMSUtils (Signature Validation Commons - 1.0.0)</title>
<meta name="date" content="2020-10-27">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="GeneralCMSUtils (Signature Validation Commons - 1.0.0)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":9,"i2":9,"i3":9,"i4":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/GeneralCMSUtils.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../se/idsec/sigval/commons/utils/GeneralCMSUtils.CMSSigCerts.html" title="class in se.idsec.sigval.commons.utils"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?se/idsec/sigval/commons/utils/GeneralCMSUtils.html" target="_top">Frames</a></li>
<li><a href="GeneralCMSUtils.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">se.idsec.sigval.commons.utils</div>
<h2 title="Class GeneralCMSUtils" class="title">Class GeneralCMSUtils</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>se.idsec.sigval.commons.utils.GeneralCMSUtils</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">GeneralCMSUtils</span>
extends java.lang.Object</pre>
<div class="block">Utility methods for processing CMS data</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Martin Lindstr√∂m (martin@idsec.se), Stefan Santesson (stefan@idsec.se)</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../se/idsec/sigval/commons/utils/GeneralCMSUtils.CMSSigCerts.html" title="class in se.idsec.sigval.commons.utils">GeneralCMSUtils.CMSSigCerts</a></span></code>
<div class="block">Data class for providing certificates supporting a CMS signature</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../se/idsec/sigval/commons/utils/GeneralCMSUtils.html#GeneralCMSUtils--">GeneralCMSUtils</a></span>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static <a href="../../../../../se/idsec/sigval/commons/utils/GeneralCMSUtils.CMSSigCerts.html" title="class in se.idsec.sigval.commons.utils">GeneralCMSUtils.CMSSigCerts</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../se/idsec/sigval/commons/utils/GeneralCMSUtils.html#extractCertificates-org.bouncycastle.cms.CMSSignedDataParser-">extractCertificates</a></span>(org.bouncycastle.cms.CMSSignedDataParser&nbsp;cmsSignedDataParser)</code>
<div class="block">Extracts signing certificate and supporting certificate chain</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static java.security.cert.X509Certificate</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../se/idsec/sigval/commons/utils/GeneralCMSUtils.html#getCert-org.bouncycastle.cert.X509CertificateHolder-">getCert</a></span>(org.bouncycastle.cert.X509CertificateHolder&nbsp;certHolder)</code>
<div class="block">converts an X509CertificateHolder object to an X509Certificate object.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static org.bouncycastle.cms.CMSSignedDataParser</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../se/idsec/sigval/commons/utils/GeneralCMSUtils.html#getCMSSignedDataParser-byte:A-byte:A-">getCMSSignedDataParser</a></span>(byte[]&nbsp;cmsContentInfo,
                      byte[]&nbsp;signedDocBytes)</code>
<div class="block">Obtains a <code>CMSSignedDataParser</code></div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static org.bouncycastle.asn1.ASN1Sequence</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../se/idsec/sigval/commons/utils/GeneralCMSUtils.html#getESSCertIDSequence-org.bouncycastle.asn1.cms.Attribute-">getESSCertIDSequence</a></span>(org.bouncycastle.asn1.cms.Attribute&nbsp;essSigningCertAttr)</code>
<div class="block">This method extracts the ESSCertID sequence from a SigningCertificate signed CMS attribute.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>static <a href="../../../../../se/idsec/sigval/commons/data/PubKeyParams.html" title="class in se.idsec.sigval.commons.data">PubKeyParams</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../se/idsec/sigval/commons/utils/GeneralCMSUtils.html#getPkParams-java.security.PublicKey-">getPkParams</a></span>(java.security.PublicKey&nbsp;pubKey)</code>
<div class="block">Retrieves Public key parameters from a public key</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="GeneralCMSUtils--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>GeneralCMSUtils</h4>
<pre>public&nbsp;GeneralCMSUtils()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="extractCertificates-org.bouncycastle.cms.CMSSignedDataParser-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>extractCertificates</h4>
<pre>public static&nbsp;<a href="../../../../../se/idsec/sigval/commons/utils/GeneralCMSUtils.CMSSigCerts.html" title="class in se.idsec.sigval.commons.utils">GeneralCMSUtils.CMSSigCerts</a>&nbsp;extractCertificates(org.bouncycastle.cms.CMSSignedDataParser&nbsp;cmsSignedDataParser)
                                                       throws java.lang.Exception</pre>
<div class="block">Extracts signing certificate and supporting certificate chain</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cmsSignedDataParser</code> - <code>CMSSignedDataParser</code> object holding certificate data</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>signing certificate and supporting certificate chain</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - is certificate extraction fails</dd>
</dl>
</li>
</ul>
<a name="getCMSSignedDataParser-byte:A-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCMSSignedDataParser</h4>
<pre>public static&nbsp;org.bouncycastle.cms.CMSSignedDataParser&nbsp;getCMSSignedDataParser(byte[]&nbsp;cmsContentInfo,
                                                                              byte[]&nbsp;signedDocBytes)
                                                                       throws org.bouncycastle.cms.CMSException</pre>
<div class="block">Obtains a <code>CMSSignedDataParser</code></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cmsContentInfo</code> - The byes of the contents parameter in the signature dictionary containing the bytes of a CMS ContentInfo</dd>
<dd><code>signedDocBytes</code> - The bytes of the PDF document signed by this signature. These are the bytes identified by the byteRange parameter
                       in the signature dictionary.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>CMSSignedDataParser</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>org.bouncycastle.cms.CMSException</code> - on error</dd>
</dl>
</li>
</ul>
<a name="getPkParams-java.security.PublicKey-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPkParams</h4>
<pre>public static&nbsp;<a href="../../../../../se/idsec/sigval/commons/data/PubKeyParams.html" title="class in se.idsec.sigval.commons.data">PubKeyParams</a>&nbsp;getPkParams(java.security.PublicKey&nbsp;pubKey)
                                throws java.io.IOException</pre>
<div class="block">Retrieves Public key parameters from a public key</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>pubKey</code> - The public key</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>public key parameters</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - error obtaining public key parameters</dd>
</dl>
</li>
</ul>
<a name="getESSCertIDSequence-org.bouncycastle.asn1.cms.Attribute-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getESSCertIDSequence</h4>
<pre>public static&nbsp;org.bouncycastle.asn1.ASN1Sequence&nbsp;getESSCertIDSequence(org.bouncycastle.asn1.cms.Attribute&nbsp;essSigningCertAttr)
                                                               throws java.lang.Exception</pre>
<div class="block">This method extracts the ESSCertID sequence from a SigningCertificate signed CMS attribute. If the signed attribute is of
 type SigningCertificateV2 (RFC 5035) the returned sequence is ESSCertIDv2. If the signed attribute is of type
 SigningCertificate (RFC2634 using SHA1 as fixed hash algo) then the returned sequence is of type ESSCertID.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>essSigningCertAttr</code> - The signed CMS attribute carried in SignerInfo</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>An ASN.1 Sequence holding the sequence of objects in ESSCertID or ESSCertIDv2</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - Any exception caused by input not mathing the assumed processing rules</dd>
</dl>
</li>
</ul>
<a name="getCert-org.bouncycastle.cert.X509CertificateHolder-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getCert</h4>
<pre>public static&nbsp;java.security.cert.X509Certificate&nbsp;getCert(org.bouncycastle.cert.X509CertificateHolder&nbsp;certHolder)
                                                  throws java.io.IOException,
                                                         java.security.cert.CertificateException</pre>
<div class="block">converts an X509CertificateHolder object to an X509Certificate object.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>certHolder</code> - the cert holder object</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>X509Certificate object</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - error parsing input data</dd>
<dd><code>java.security.cert.CertificateException</code> - certificate parsing error</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/GeneralCMSUtils.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../se/idsec/sigval/commons/utils/GeneralCMSUtils.CMSSigCerts.html" title="class in se.idsec.sigval.commons.utils"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?se/idsec/sigval/commons/utils/GeneralCMSUtils.html" target="_top">Frames</a></li>
<li><a href="GeneralCMSUtils.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2020 <a href="https://www.idsec.se">IDsec Solutions AB</a>. All rights reserved.</small></p>
</body>
</html>
